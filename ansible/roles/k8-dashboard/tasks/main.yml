---
- k8s:
    state: present
    kubeconfig: "/etc/kubernetes/admin.conf"
    definition: "{{ lookup('file', './files/dashboard.yml') }}"

- k8s:
    state: present
    kubeconfig: "/etc/kubernetes/admin.conf"
    definition:
      apiVersion: extensions/v1beta1
      kind: Ingress
      metadata:
        name: kubernetes-dashboard
        namespace: kube-system
      spec:
        rules:
          - host: kubernetes-dashboard.{{ domain_name }}
            http:
              paths:
                - path: /
                  backend:
                    serviceName: kubernetes-dashboard
                    servicePort: 443
